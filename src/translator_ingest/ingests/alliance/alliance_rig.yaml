# Alliance of Genome Resources Reference Ingest Guide (RIG)
name: Alliance of Genome Resources (AGR) Reference Ingest Guide

# Information about the Source of the data ingest
source_info:
  infores_id: infores:agrkb
  name: Alliance of Genome Resources (AGR)
  description: "The Alliance of Genome Resources (AGR) is a consortium of model organism databases and the Gene Ontology Consortium that provides a unified view of gene function, biological processes, phenotypes, and disease associations across multiple model organisms. The AGR aggregates and harmonizes data from member databases including MGI (mouse), RGD (rat), SGD (yeast), WormBase (C. elegans), FlyBase (D. melanogaster), ZFIN (zebrafish), and Xenbase (X. laevis and X. tropicalis)."
  citations:
    - "Alliance of Genome Resources Portal: enhancing a MOD resource. Nucleic Acids Res. 2020 Jan 8;48(D1):D650-D658. PMID: 31691787"
    - "https://www.alliancegenome.org/"
  terms_of_use_info:
    terms_of_use_url: "https://www.alliancegenome.org/privacy-warranty-licensing"
    license_name: "CC0 1.0 Universal"
    license_url: "https://creativecommons.org/publicdomain/zero/1.0/"
  data_access_locations:
    - "All downloads: https://www.alliancegenome.org/downloads"
    - "FMS (File Management System): https://fms.alliancegenome.org/download/"
  data_provision_mechanisms:
    - file_download
  data_formats:
    - json
    - tsv
  data_versioning_and_releases: "The Alliance releases data in numbered versions (e.g., 7.0.0, 7.1.0) approximately every 2-3 months. Each release is archived and accessible via the FMS. Release information is available at https://www.alliancegenome.org/downloads and version metadata can be retrieved from the API at https://www.alliancegenome.org/api/releaseInfo."

# Information about Ingested Content
ingest_info:
  ingest_categories:
    - aggregation_provider
  utility: "The Alliance provides high-quality, manually curated gene-phenotype associations and gene expression data for mouse and rat, which are critical model organisms for understanding human biology and disease. These associations support Translator queries relating to gene function, phenotypes, and anatomical expression patterns."
  scope: "This ingest focuses on mouse (NCBITaxon:10090) and rat (NCBITaxon:10116) data only, specifically: (1) gene-to-phenotype associations where the subject is a gene (not genotype or variant), and (2) gene-to-expression site associations. All nodes are created as minimal placeholders (id + category only) for downstream merging with richer entity data from other sources."

  relevant_files:
    - file_name: "BGI_MGI.json.gz"
      location: "https://fms.alliancegenome.org/download/BGI_MGI.json.gz"
      description: "Mouse gene basic information (used for gene ID lookup to filter phenotype records)"
    - file_name: "BGI_RGD.json.gz"
      location: "https://fms.alliancegenome.org/download/BGI_RGD.json.gz"
      description: "Rat gene basic information (used for gene ID lookup to filter phenotype records)"
    - file_name: "PHENOTYPE_MGI.json.gz"
      location: "https://fms.alliancegenome.org/download/PHENOTYPE_MGI.json.gz"
      description: "Mouse phenotype associations (includes gene, genotype, and variant associations)"
    - file_name: "PHENOTYPE_RGD.json.gz"
      location: "https://fms.alliancegenome.org/download/PHENOTYPE_RGD.json.gz"
      description: "Rat phenotype associations (includes gene, genotype, and variant associations)"
    - file_name: "EXPRESSION_MGI.json.gz"
      location: "https://fms.alliancegenome.org/download/EXPRESSION_MGI.json.gz"
      description: "Mouse gene expression data"
    - file_name: "EXPRESSION_RGD.json.gz"
      location: "https://fms.alliancegenome.org/download/EXPRESSION_RGD.json.gz"
      description: "Rat gene expression data"

  included_content:
    - file_name: "BGI_MGI.json.gz"
      included_records: "Gene IDs for mouse genes only, used for phenotype filtering. Data is loaded into DuckDB for fast lookup but no gene nodes are created from this file."
      fields_used: "basicGeneticEntity.primaryId, basicGeneticEntity.taxonId"
    - file_name: "BGI_RGD.json.gz"
      included_records: "Gene IDs for rat genes only, used for phenotype filtering. Data is loaded into DuckDB for fast lookup but no gene nodes are created from this file."
      fields_used: "basicGeneticEntity.primaryId, basicGeneticEntity.taxonId"
    - file_name: "PHENOTYPE_MGI.json.gz"
      included_records: "Only records where objectId corresponds to a gene (filtered using BGI gene lookup). Records where objectId is a genotype or variant are excluded."
      fields_used: "objectId, phenotypeTermIdentifiers, evidence.publicationId, conditionRelations"
    - file_name: "PHENOTYPE_RGD.json.gz"
      included_records: "Only records where objectId corresponds to a gene (filtered using BGI gene lookup). Records where objectId is a genotype or variant are excluded."
      fields_used: "objectId, phenotypeTermIdentifiers, evidence.publicationId, conditionRelations"
    - file_name: "EXPRESSION_MGI.json.gz"
      included_records: "All gene expression records"
      fields_used: "geneId, whereExpressed.anatomicalStructureTermId, whereExpressed.cellularComponentTermId, whenExpressed.stageTermId, evidence.publicationId, crossReference.id, assay"
    - file_name: "EXPRESSION_RGD.json.gz"
      included_records: "All gene expression records"
      fields_used: "geneId, whereExpressed.anatomicalStructureTermId, whereExpressed.cellularComponentTermId, whenExpressed.stageTermId, evidence.publicationId, crossReference.id, assay"

  filtered_content:
    - file_name: "PHENOTYPE_MGI.json.gz"
      filtered_records: "Phenotype associations where objectId is a genotype ID (e.g., MGI genotype IDs) or variant/allele ID"
      rationale: "This ingest focuses only on direct gene-to-phenotype associations. Genotype and variant associations may be considered for future ingests but require different modeling patterns and are currently out of scope."
    - file_name: "PHENOTYPE_RGD.json.gz"
      filtered_records: "Phenotype associations where objectId is a genotype ID (e.g., RGD genotype IDs) or variant/allele ID"
      rationale: "This ingest focuses only on direct gene-to-phenotype associations. Genotype and variant associations may be considered for future ingests but require different modeling patterns and are currently out of scope."

  future_considerations:
    - category: edge_content
      consideration: "Consider adding genotype-to-phenotype and variant-to-phenotype associations, which are currently filtered out. These would require extending the ingest to create proper genotype and variant nodes."
      relevant_files: "PHENOTYPE_MGI.json.gz, PHENOTYPE_RGD.json.gz, AGM_MGI.json.gz, AGM_RGD.json.gz, VARIANT-ALLELE files"
    - category: edge_content
      consideration: "Consider adding gene-to-disease associations from DISEASE-ALLIANCE_COMBINED.tsv.gz file, which provides curated disease annotations."
      relevant_files: "DISEASE-ALLIANCE_COMBINED.tsv.gz"
    - category: edge_content
      consideration: "Consider ingesting data for additional species beyond mouse and rat (e.g., zebrafish, fly, worm, yeast)"
      relevant_files: "All Alliance files for other species"
    - category: edge_property_content
      consideration: "Consider adding richer provenance information, such as mapping evidence codes to knowledge_level and agent_type enums more granularly"
    - category: node_property_content
      consideration: "Currently all nodes are minimal placeholders. Future iterations could enrich gene nodes with names, symbols, and other properties from the BGI files, or rely on downstream normalization for this enrichment."

  additional_notes: "The ingest uses DuckDB to create an in-memory lookup table of gene IDs from BGI files, allowing efficient filtering of phenotype records by entity type without loading all genotype and allele data. This approach significantly reduces memory footprint and processing time compared to loading all entity types."

# Information about the Graph Output by the ingest
target_info:
  infores_id: infores:translator-agr-kgx

  edge_type_info:
    - subject_categories:
        - biolink:Gene
      predicates:
        - biolink:contributes_to
      object_categories:
        - biolink:PhenotypicFeature
      qualifiers:
        - property: biolink:qualifiers
          value_id_prefixes:
            - "ZECO"
            - "XCO"
            - "CHEBI"
          value_description: "Experimental conditions under which the phenotype was observed, captured from the conditionRelations field. These may include environmental conditions, chemical treatments, or other qualifying context."
      knowledge_level:
        - knowledge_assertion
      agent_type:
        - manual_agent
      edge_properties:
        - publications
        - qualifiers
      ui_explanation: "These associations represent manually curated phenotype observations for genes in mouse and rat model organisms. Each association links a gene to one or more phenotypic features observed when the gene is perturbed, knocked out, or otherwise modified."
      additional_notes: "Phenotype records may contain multiple phenotype terms (phenotypeTermIdentifiers), and each generates a separate association edge. Experimental conditions from conditionRelations are captured as qualifiers when present."

    - subject_categories:
        - biolink:Gene
      predicates:
        - biolink:expressed_in
      object_categories:
        - biolink:AnatomicalEntity
        - biolink:CellularComponent
      qualifiers:
        - property: biolink:stage_qualifier
          value_id_prefixes:
            - "UBERON"
            - "EMAPA"
            - "GO"
          value_description: "Developmental or life stage during which expression was observed"
        - property: biolink:qualifiers
          value_description: "Assay type used to detect expression (e.g., 'MMO:0000648' for immunohistochemistry)"
      knowledge_level:
        - knowledge_assertion
      agent_type:
        - manual_agent
      edge_properties:
        - publications
        - stage_qualifier
        - qualifiers
      ui_explanation: "These associations represent gene expression patterns observed in specific anatomical locations or cellular components in mouse and rat. Expression data is typically derived from experimental assays and annotated with developmental stage and assay type information."
      additional_notes: "The ingest prefers anatomical entity IDs (anatomicalStructureTermId) over cellular component IDs (cellularComponentTermId) when both are present. Stage information and assay type are captured as qualifiers when available."

  node_type_info:
    - node_category: biolink:Gene
      source_identifier_types:
        - "MGI (Mouse Genome Informatics)"
        - "RGD (Rat Genome Database)"
      node_properties:
        - id
        - category
      additional_notes: "Gene nodes are created as minimal placeholders with only id and category. Richer gene information (names, symbols, descriptions, etc.) is expected to be merged from authoritative gene sources during downstream normalization."

    - node_category: biolink:PhenotypicFeature
      source_identifier_types:
        - "MP (Mammalian Phenotype Ontology)"
        - "HP (Human Phenotype Ontology)"
      node_properties:
        - id
        - category
      additional_notes: "Phenotype nodes are minimal placeholders. Full phenotype definitions, names, and hierarchical relationships should come from ontology sources during normalization."

    - node_category: biolink:AnatomicalEntity
      source_identifier_types:
        - "UBERON (Uber-anatomy ontology)"
        - "EMAPA (Mouse anatomical dictionary)"
        - "MA (Mouse adult gross anatomy)"
      node_properties:
        - id
        - category
      additional_notes: "Anatomical entity nodes are minimal placeholders. Full anatomical information should come from ontology sources during normalization."

    - node_category: biolink:CellularComponent
      source_identifier_types:
        - "GO (Gene Ontology - Cellular Component aspect)"
      node_properties:
        - id
        - category
      additional_notes: "Cellular component nodes are minimal placeholders. Full GO term information should come from ontology sources during normalization."

  future_considerations:
    - category: node_properties
      consideration: "If genes are not adequately normalized/enriched downstream, consider adding basic gene properties (symbol, name) from BGI files to gene placeholder nodes."
    - category: qualifiers
      consideration: "Review whether additional qualifying information could be extracted from Alliance data to further contextualize associations (e.g., genetic background, sex, age)."
    - category: edge_properties
      consideration: "Consider mapping evidence codes to more granular knowledge_level and agent_type enums if such mappings become available from Alliance."

  additional_notes: "The minimal placeholder approach for nodes is intentional: it reduces redundancy and allows authoritative sources for each entity type to provide the canonical entity information during normalization. The Alliance ingest focuses on providing high-quality associations while leaving entity enrichment to specialized sources."

# Information about how the ingest was specified and performed
provenance_info:
  contributions:
    - "Kevin Schaper: code refactoring, optimization"
    - "Matthew Brush: data modeling guidance"
  artifacts:
    - "Related Alliance standalone ingest repository: https://github.com/monarch-initiative/alliance-ingest"
