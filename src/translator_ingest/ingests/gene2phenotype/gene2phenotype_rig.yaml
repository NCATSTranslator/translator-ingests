# EBI Gene2Phenotype Reference Ingest Guide (RIG)
name: EBI Gene2Phenotype Reference Ingest Guide

# Information about the Source of the data ingest
source_info:
  infores_id: infores:gene2phenotype
  name: Gene2Phenotype
  description: "EBI's Gene2Phenotype dataset contains high-quality gene-disease associations curated by UK disease domain experts and consultant clinical geneticists. It integrates data on genes, their variants, and related disorders. It is constructed by experts reviewing published literature, and it is primarily an inclusion list to allow targeted filtering of genome-wide data for diagnostic purposes. Each entry associates a gene with a disease, including a confidence level, allelic requirement and molecular mechanism."
  citations:
    - "https://doi.org/10.1186/s13073-024-01398-1"
    - "https://www.nature.com/articles/s41467-019-10016-3"
  terms_of_use_info:
    terms_of_use_description: "Unsure, but likely uses EMBL-EBI terms of use (linked in website footer). Currently don't see a formal standard license. Various resource webpages (About -> The G2P Project, Downloads, Publications) say that all data is 'freely available' and to please cite the date accessed/data version and Thorman et al 2019"
    terms_of_use_url: "https://www.ebi.ac.uk/about/terms-of-use/#general"
  data_access_locations:
    - "Latest data is provided at https://www.ebi.ac.uk/gene2phenotype/download (downloads created on-the-fly)"
    - "Archived static releases provided on the FTP site at https://ftp.ebi.ac.uk/pub/databases/gene2phenotype/G2P_data_downloads/"
  data_provision_mechanisms:
    - file_download
  data_formats:
    - csv    # on-the-fly downloads
    - other    # FTP static releases are csv.gz
  data_versioning_and_releases: "On-the-fly downloads: creation/download date are the same and can be used for versioning; note that the date in the filename may differ from the date in your timezone. Static releases: creation date (shown on FTP site and in folder/file names) can be used for versioning; releases cut and archived roughly every 1-2 months."

# Information about Ingested Content
ingest_info:
  ingest_categories:
    - primary_knowledge_provider
  utility: "EBI G2P associations are useful as edges in support paths for MVP1 ('what may treat disease X'), and in Pathfinder queries."
  
  relevant_files:
    - file_name: "G2P_all_[date].csv"
      location: "https://www.ebi.ac.uk/gene2phenotype/api/panel/all/download/"
      description: "Associations from all panels (disease categories)"

  included_content:
    - file_name: "G2P_all_[date].csv"
      included_records: "Records where 'confidence' value is 'definitive', 'strong', or 'moderate'"
      fields_used: "g2p id, hgnc id, disease mim, disease MONDO, allelic requirement, confidence, molecular mechanism, publications, date of last review"

  filtered_content:
    - file_name: "G2P_all_[date].csv"
      filtered_records: "Records where 'confidence' value is 'limited', 'disputed', or 'refuted'"
      rationale: "Evidence level not sufficient for inclusion"
    - file_name: "G2P_all_[date].csv"
      filtered_records: "Records with no values in both 'disease mim' and 'disease MONDO' columns"
      rationale: "No IDs to use for disease nodes"
    - file_name: "G2P_all_[date].csv"
      filtered_records: "Records with NodeNorm mapping failures for the node IDs"
      rationale: "Failed normalization means that the node would not be connected to other data/nodes in Translator graphs"
    - file_name: "G2P_all_[date].csv"
      filtered_records: "Records where 'disease mim' value is '188400'"
      rationale: "OMIM:188400 is incorrectly mapped by NodeNorm to a Gene when it's actually a Disease. To avoid creating an incorrect edge, we are temporarily removing rows with this ID from the data."

  future_considerations:
    - category: edge_content
      consideration: "Revisit exclusion of 'limited', 'disputed', and 'refuted' records once Translator can model/handle negation better"
    - category: edge_property_content
      consideration: >-
        Review other columns in data - some contain edge-level information that we may want to include in future iterations. 
        There's details on variants, but not their actual names/IDs ('variant consequence' and 'variant types' columns, which have values that map to SO terms).
        There's more details on the molecular mechanism (but some columns are sparse, complex, and tricky to interpret/parse).
        And there's more detail on the gene-disease inheritance pattern ('cross cutting modifier' column).
        (Matt's note) Rich evidence and provenance metadata provided by the source (e.g. type of experiments/methods used to determine the molecular mechanism, and supporting publications)."


# Information about the Graph Output by the ingest
target_info:
  infores_id: infores:translator-gene2phenotype

  edge_type_info:
    - subject_categories:
        - biolink:Gene
      predicates:
        - biolink:associated_with
      object_categories:
        - biolink:Disease
      qualifiers:
        - property: biolink:qualified_predicate
          value_enumeration: 
            - "biolink:causes"
        - property: biolink:subject_form_or_variant_qualifier
          value_enumeration:
            - loss_of_function_variant_form
            - genetic_variant_form
            - gain_of_function_variant_form
            - dominant_negative_variant_form
            - non_loss_of_function_variant_form
      knowledge_level:
        - knowledge_assertion
      agent_type:
        - manual_agent
      primary_knowledge_sources:
        - infores:gene2phenotype
      edge_properties:
        - biolink:original_subject
        - biolink:original_object
        - biolink:update_date
        - biolink:gene2phenotype_confidence_category
      ui_explanation: "EBI G2P curators manually determined through the evaluation of different types of evidence that variants of this gene of the indicated form (e.g. loss of function, gain of function, dominant negative) play a causal role in this disease."
      source_files: 
        - "G2P_all_[date].csv"

  node_type_info:
    - node_category: biolink:Gene
      source_identifier_types:
        - "HGNC"
    - node_category: biolink:Disease
      source_identifier_types:
        - "OMIM"
        - "MONDO"
      additional_notes: "'disease mim' column is source of OMIM IDs. MONDO IDs from 'disease MONDO' column are only used if row doesn't have a value in 'disease mim' column"

  future_considerations:
    - category: qualifiers
      consideration: "May want to revisit how we handle the 'molecular mechanism' column vs the biolink-model qualifier options. Also consider ingesting/modeling the 'variant consequence' and 'variant types' columns."
    - category: other
      consideration: "Revisit biolink-model spec of allelic_requirement (currently uses a regex pattern to match HP ID syntax, rather than 'base mode of inheritance term and its descendants' or an enumerated list of permissible values)"

# Information about the how the ingest was specified and performed
provenance_info:
  contributions:
    - "Colleen Xu: code author, data modeling"
    - "Andrew Su: domain expertise"
    - "Sierra Moxon: domain expertise"
    - "Matthew Brush: data modeling, domain expertise"
  artifacts:
    - "Github Ticket on confidence 'limited' value: https://github.com/biolink/biolink-model/issues/1581"
    - "PR on biolink allelic_requirement: https://github.com/biolink/biolink-model/pull/1576"
    - "notebooks for development work currently in parser code directory"
